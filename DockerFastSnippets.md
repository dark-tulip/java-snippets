- **namespaces** - независимые пространства имен (user/pid/mount/network/UTC/IPC) - one service and one container service with pid 1
- **cgrounps** - control group, CPU memory limits
- **capabilitues** - привилегии рута
- **unionFS** - слоистоя луковая файловая система, основанная на переиспользовании. Используется для хранения image контейнера. Самый верхний слой доступный для записи.


## Поднять локальный раббит с админкой

```
docker run -d \
  --name my-rabbitmq \
  -p 5672:5672 \
  -p 15672:15672 \
  -e RABBITMQ_DEFAULT_USER=reader \
  -e RABBITMQ_DEFAULT_PASS=reader \
  rabbitmq:3.9-management
```

- docker compose написан на питоне
- перед воркдир необязательно ставить мкдир
  
```dockerfile
FROM — задаёт базовый (родительский) образ.
LABEL — описывает метаданные. Например — сведения о том, кто создал и поддерживает образ.
ENV — устанавливает постоянные переменные среды.
RUN — выполняет команду и создаёт слой образа. Используется для установки в контейнер пакетов.
COPY — копирует в контейнер файлы и папки.
ADD — копирует файлы и папки в контейнер, может распаковывать локальные .tar-файлы.
CMD — описывает команду с аргументами, которую нужно выполнить когда контейнер будет запущен. Аргументы могут быть переопределены при запуске контейнера. В файле может присутствовать лишь одна инструкция CMD.
WORKDIR — задаёт рабочую директорию для следующей инструкции.
ARG — задаёт переменные для передачи Docker во время сборки образа.
ENTRYPOINT — предоставляет команду с аргументами для вызова во время выполнения контейнера. Аргументы не переопределяются.
EXPOSE — указывает на необходимость открыть порт.
VOLUME — создаёт точку монтирования для работы с постоянным хранилищем.
```

## Как уменьшить размер образа?

- Объединить слои в run, `use - - no-cache`
- `.dockerignore`
- Образ на основе Alpine, вместо убунту или дебиана
- Ставить часто изменяемые слои в конец, сборка не будетчасто изменяться( например копирование исходного программного кода в образ) - тогда вышестоящие команды сборки образа могут спокойно кэшироваться
- Обязательно указывать тэг и его версию
- Latest зло, каждый раз нагружает сеть (может взять локальный но старый латест или использовать на проде другой, на деве другой latest)
